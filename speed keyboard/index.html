<!DOCTYPE html>
<html>
<head>
	<title>Speed keyboard</title>
</head>
<body style="font-family: sans-serif; font-size: 22px; padding: 100px; background-color: #ff9cde">

	<div class="container">
		<div class="text"></div>
	</div>
	<div class="speed"></div>
<style type="text/css">
	.container {
		width: auto;
		border-radius: 10px;
		background-color: #fff;
		padding: 30px;
	}
	span {
		transition: .08s;
		font-weight: 600;
		letter-spacing: 2px;
		border-radius: 4px;
		padding: 0 0 0 2px;
	}
	span:first-child { background-color: #37bf4a; color: #fff; }
</style>

<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
<script>
	var text = "Сайт рыбатекст поможет дизайнеру, верстальщику, вебмастеру сгенерировать несколько абзацев более менее осмысленного текста рыбы на русском языке, а начинающему оратору отточить навык публичных выступлений в домашних условиях.";
	var textArr = [];
	for(i = 0; i < text.length; i += 1) { textArr[i] = "<span id=" + i + ">" + text[i] + "</span>"; }
	$(textArr);
	$('.text').html(textArr);

	
	var counts = []
	counts[0] = 0
	var speed = 0
	var textStep = 0;
	$('body').keyup(function(e){
		if(e.key == text[textStep]) {
			$('#' + (textStep)).css({'background-color': 'unset', "color": "#599962"});
			$('#' + (textStep + 1)).css({'background-color': '#37bf4a', "color": "#fff"});

			var g = textStep - 1
			if(textStep != 0)
			counts[textStep] = time - counts[g]

			textStep++;
		
			var countsSum = 0
			console.log(textArr.length, text.length, textStep, counts)
				for(i = 0; i < counts.length; i++) {
					countsSum += counts[i]
					$('.speed').html((60000 / (countsSum / counts.length)).toFixed())
				if(textStep == textArr.length) {
					clearInterval(interval)
				}
			}
		} else
			if(e.key != "Alt" && e.key != "Control" && e.key != "Shift") { $('#' + textStep).css('background-color', '#e33443'); 
		}
	})





	var interval = setInterval(time, 10)
	var time = 0
	function time () {
		time++
	}



</script>
</body>
</html>